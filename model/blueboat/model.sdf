<?xml version='1.0'?>
<sdf version='1.5'>
  <model name="blueboat">
    <pose>0 0 0 0 0 0</pose>
    <link name="base_link">
      <inertial>
        <pose>-0.05 0 -0.15 0 0 0</pose>
        <mass>11.0</mass>
        <inertia>
          <ixx>2.42369</ixx>
          <ixy>0</ixy>
          <ixz>0</ixz>
          <iyy>3.9235025</iyy>
          <iyz>0</iyz>
          <izz>5.6403125</izz>
        </inertia>
      </inertial>
      <collision name="hull_collision">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_hull_collision.stl</uri>
          </mesh>
        </geometry>
      </collision>
      <visual name="hull_visual">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_hull.dae</uri>
          </mesh>
        </geometry>
        <material>
          <diffuse>0 0 1 1</diffuse>
          <ambient>1 0 1 1</ambient>
          <specular>0.7 0.7 0.7 1</specular>
          <pbr>
            <metal>
              <metalness>0.5</metalness>
              <roughness>0.5</roughness>
            </metal>
          </pbr>
        </material>
      </visual>
      <visual name="aerial_visual">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_aerial.dae</uri>
          </mesh>
        </geometry>
        <material>
          <diffuse>0.01 0.01 0.01 1</diffuse>
          <ambient>0.01 0.01 0.01 1</ambient>
          <specular>0.7 0.7 0.7 1</specular>
          <pbr>
            <metal>
              <metalness>0.5</metalness>
              <roughness>0.5</roughness>
            </metal>
          </pbr>
        </material>
      </visual>
      <visual name="crosstube_visual">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_crosstube.dae</uri>
          </mesh>
        </geometry>
        <material>
          <diffuse>0.01 0.01 0.01 1</diffuse>
          <ambient>0.01 0.01 0.01 1</ambient>
          <specular>0.7 0.7 0.7 1</specular>
          <pbr>
            <metal>
              <metalness>0.5</metalness>
              <roughness>0.5</roughness>
            </metal>
          </pbr>
        </material>
      </visual>
      <visual name="flag_visual">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_flag.dae</uri>
          </mesh>
        </geometry>
        <material>
          <diffuse>1 1 0 1</diffuse>
          <ambient>1 1 0 1</ambient>
          <specular>0.7 0.7 0.7 1</specular>
          <pbr>
            <metal>
              <metalness>0.5</metalness>
              <roughness>0.5</roughness>
            </metal>
          </pbr>
        </material>
      </visual>
      <visual name="frame_asm_fore_visual">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_frame_asm_fore.dae</uri>
          </mesh>
        </geometry>
        <material>
          <diffuse>0.01 0.01 0.01 1</diffuse>
          <ambient>0.01 0.01 0.01 1</ambient>
          <specular>0.7 0.7 0.7 1</specular>
          <pbr>
            <metal>
              <metalness>0.9</metalness>
              <roughness>0.1</roughness>
            </metal>
          </pbr>
        </material>
      </visual>
      <visual name="frame_asm_aft_visual">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_frame_asm_aft.dae</uri>
          </mesh>
        </geometry>
        <material>
          <diffuse>0.01 0.01 0.01 1</diffuse>
          <ambient>0.01 0.01 0.01 1</ambient>
          <specular>0.7 0.7 0.7 1</specular>
          <pbr>
            <metal>
              <metalness>0.9</metalness>
              <roughness>0.1</roughness>
            </metal>
          </pbr>
        </material>
      </visual>
      <visual name="hatch_asm_stbd">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_hatch_asm_stbd.dae</uri>
          </mesh>
        </geometry>
        <material>
          <diffuse>0.01 0.01 0.01 1</diffuse>
          <ambient>0.01 0.01 0.01 1</ambient>
          <specular>0.7 0.7 0.7 1</specular>
          <pbr>
            <metal>
              <metalness>0.5</metalness>
              <roughness>0.5</roughness>
            </metal>
          </pbr>
        </material>
      </visual>
      <visual name="hatch_asm_port">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_hatch_asm_port.dae</uri>
          </mesh>
        </geometry>
        <material>
          <diffuse>0.01 0.01 0.01 1</diffuse>
          <ambient>0.01 0.01 0.01 1</ambient>
          <specular>0.7 0.7 0.7 1</specular>
          <pbr>
            <metal>
              <metalness>0.5</metalness>
              <roughness>0.5</roughness>
            </metal>
          </pbr>
        </material>
      </visual>
      <visual name="motor_stbd_visual">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_motor_stbd.dae</uri>
          </mesh>
        </geometry>
        <material>
          <diffuse>0.01 0.01 0.01 1</diffuse>
          <ambient>0.01 0.01 0.01 1</ambient>
          <specular>0.7 0.7 0.7 1</specular>
          <pbr>
            <metal>
              <metalness>0.5</metalness>
              <roughness>0.5</roughness>
            </metal>
          </pbr>
        </material>
      </visual>
      <visual name="motor_port_visual">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_motor_port.dae</uri>
          </mesh>
        </geometry>
        <material>
          <diffuse>0.01 0.01 0.01 1</diffuse>
          <ambient>0.01 0.01 0.01 1</ambient>
          <specular>0.7 0.7 0.7 1</specular>
          <pbr>
            <metal>
              <metalness>0.5</metalness>
              <roughness>0.5</roughness>
            </metal>
          </pbr>
        </material>
      </visual>
    </link>

    <link name="motor_stbd_link">
      <pose degrees="true">-0.488 -0.295 -0.272 -90 0 90</pose>
      <inertial>
        <mass>0.2</mass>
        <inertia>
          <ixx>0.1</ixx>
          <ixy>0</ixy>
          <ixz>0</ixz>
          <iyy>0.1</iyy>
          <iyz>0</iyz>
          <izz>0.1</izz>
        </inertia>
      </inertial>
      <collision name="prop_collision">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_prop_stbd.dae</uri>
          </mesh>
        </geometry>
      </collision>
      <visual name="prop_visual">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_prop_stbd.dae</uri>
          </mesh>
        </geometry>
        <material>
          <diffuse>0.01 0.01 0.01 1</diffuse>
          <ambient>0.01 0.01 0.01 1</ambient>
          <specular>0.7 0.7 0.7 1</specular>
          <pbr>
            <metal>
              <metalness>0.5</metalness>
              <roughness>0.5</roughness>
            </metal>
          </pbr>
        </material>
      </visual>
    </link>
    <joint name="motor_stbd_joint" type="revolute">
      <parent>base_link</parent>
      <child>motor_stbd_link</child>
      <axis>
        <xyz>0 0 -1</xyz>
        <limit>
          <lower>-1e16</lower>
          <upper>1e16</upper>
        </limit>
        <dynamics>
          <damping>0.02</damping>
        </dynamics>
      </axis>
    </joint>

    <link name="motor_port_link">
      <pose degrees="true">-0.488 0.295 -0.272 -90 0 90</pose>
      <inertial>
        <mass>0.2</mass>
        <inertia>
          <ixx>0.1</ixx>
          <ixy>0</ixy>
          <ixz>0</ixz>
          <iyy>0.1</iyy>
          <iyz>0</iyz>
          <izz>0.1</izz>
        </inertia>
      </inertial>
      <collision name="prop_collision">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_prop_port.dae</uri>
          </mesh>
        </geometry>
      </collision>
      <visual name="prop_visual">
        <geometry>
          <mesh>
            <uri>model://blueboat/meshes/blueboat_prop_port.dae</uri>
          </mesh>
        </geometry>
        <material>
          <diffuse>0.01 0.01 0.01 1</diffuse>
          <ambient>0.01 0.01 0.01 1</ambient>
          <specular>0.7 0.7 0.7 1</specular>
          <pbr>
            <metal>
              <metalness>0.5</metalness>
              <roughness>0.5</roughness>
            </metal>
          </pbr>
        </material>
      </visual>
    </link>
    <joint name="motor_port_joint" type="revolute">
      <parent>base_link</parent>
      <child>motor_port_link</child>
      <axis>
        <xyz>0 0 -1</xyz>
        <limit>
          <lower>-1e16</lower>
          <upper>1e16</upper>
        </limit>
        <dynamics>
          <damping>0.02</damping>
        </dynamics>
      </axis>
    </joint>

    <!-- sensors -->
    <link name="imu_link">
      <inertial>
        <pose>0 0 0 0 0 0</pose>
        <mass>0.1</mass>
        <inertia>
          <ixx>0.0001</ixx>
          <ixy>0</ixy>
          <ixz>0</ixz>
          <iyy>0.0001</iyy>
          <iyz>0</iyz>
          <izz>0.0001</izz>
        </inertia>
      </inertial>
      <sensor name="imu_sensor" type="imu">
        <pose degrees="true">0 0 0 180 0 0</pose>
        <always_on>1</always_on>
        <update_rate>1000.0</update_rate>
      </sensor>
    </link>
    <joint name="imu_joint" type="revolute">
      <child>imu_link</child>
      <parent>base_link</parent>
      <axis>
        <xyz>0 0 1</xyz>
        <limit>
          <lower>0</lower>
          <upper>0</upper>
        </limit>
        <dynamics>
          <damping>1.0</damping>
        </dynamics>
      </axis>
    </joint>

    <!-- buoyancy plugin -->
    <plugin name="freebuoyancy_gazebo" filename="libfreebuoyancy_gazebo.so">
      <descriptionParam>robot_description</descriptionParam>
      <fluidTopic>current</fluidTopic>
      <alwaysOn>true</alwaysOn>
      <surface>0 0 0</surface>
      <updateRate>.001</updateRate>

      <link name="base_link">
        <buoyancy>
          <compensation>0.3</compensation>
          <origin xyz= "-0.488 -0.295 0"/>
        </buoyancy>
        <buoyancy>
          <compensation>0.3</compensation>
          <origin xyz= "-0.488 0.295 0"/>
        </buoyancy>
        <buoyancy>
          <compensation>0.3</compensation>
          <origin xyz= "0.488 -0.295 0"/>
        </buoyancy>
        <buoyancy>
          <compensation>0.3</compensation>
          <origin xyz= "0.488 0.295 0"/>
        </buoyancy>
      </link>
    </plugin>

      <!-- ardupilot plugin -->
    <plugin name="ArduPilotPlugin" filename="libArduPilotPlugin.so">
      <fdm_addr>127.0.0.1</fdm_addr>
      <fdm_port_in>9002</fdm_port_in>
      <fdm_port_out>9003</fdm_port_out>
      <imuName>blueboat::base_link::imu_sensor</imuName>
      <connectionTimeoutMaxCount>5</connectionTimeoutMaxCount>

    <!-- left motor thruster cw -->
        <control channel="0">
          <type>EFFORT</type>
          <offset>-0.5</offset>
          <p_gain>1</p_gain>
          <i_gain>0</i_gain>
          <d_gain>0</d_gain>
          <i_max>0</i_max>
          <i_min>0</i_min>
          <cmd_max>51</cmd_max>
          <cmd_min>-40</cmd_min>
          <linkName>blueboat::motor_port_link</linkName>
          <multiplier>102</multiplier>
        </control>

    <!-- right motor thruster ccw -->
        <control channel="1">
          <type>EFFORT</type>
          <offset>-0.5</offset>
          <p_gain>1</p_gain>
          <i_gain>0</i_gain>
          <d_gain>0</d_gain>
          <i_max>0</i_max>
          <i_min>0</i_min>
          <cmd_max>51</cmd_max>
          <cmd_min>-40</cmd_min>
          <linkName>blueboat::motor_stbd_link</linkName>
          <multiplier>102</multiplier>
        </control>

    </plugin>

  </model>
</sdf>
